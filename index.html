<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smoke Shop Accessories | Premium Wholesale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --leaf-green: #10b981; }
        
        body { 
            background: #000; 
            color: white; 
            font-family: 'Plus Jakarta Sans', sans-serif;
            margin: 0;
            overflow-x: hidden;
        }

        /* NEON FLICKER BACKGROUND */
        #video-container {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: -2; overflow: hidden;
            background: #000;
        }

        #video-bg {
            position: absolute; top: 50%; left: 50%;
            min-width: 100%; min-height: 100%;
            transform: translate(-50%, -50%);
            object-fit: cover;
            filter: brightness(0.5) contrast(1.2);
            animation: glow-pulse 4s infinite ease-in-out;
        }

        @keyframes glow-pulse {
            0%, 100% { filter: brightness(0.5) drop-shadow(0 0 10px var(--leaf-green)); }
            50% { filter: brightness(0.8) drop-shadow(0 0 30px var(--leaf-green)); }
        }

        /* WHITE PREMIUM HEADER */
        header {
            background: #ffffff !important;
            border-bottom: 4px solid var(--leaf-green);
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            position: sticky; top: 0; z-index: 50;
        }

        .logo-container img {
            height: 80px; 
            width: auto;
            display: block;
        }

        #search {
            background: #f1f5f9;
            color: #0f172a;
            border: 1px solid #cbd5e1;
            font-weight: 600;
        }

        /* PRODUCT CARDS & SMOKE HOVER EFFECT */
        .glass-card {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .glass-card:hover {
            transform: translateY(-10px);
            border-color: var(--leaf-green);
            box-shadow: 0 0 40px rgba(16, 185, 129, 0.3);
        }

        /* THE SMOKE ANIMATION */
        .smoke-plume {
            position: absolute;
            bottom: -20px;
            left: 50%;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(16, 185, 129, 0.4) 0%, rgba(0,0,0,0) 70%);
            filter: blur(20px);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 0;
        }

        .glass-card:hover .smoke-plume {
            opacity: 1;
            animation: rise-smoke 2s infinite linear;
        }

        @keyframes rise-smoke {
            0% { transform: translate(-50%, 0) scale(1); opacity: 0; }
            50% { opacity: 0.6; }
            100% { transform: translate(-50%, -150px) scale(2.5); opacity: 0; }
        }

        .product-image-container {
            position: relative;
            z-index: 1; /* Keeps image above smoke */
        }

        .btn-green { 
            background: #10b981;
            color: white; font-weight: 800;
            transition: all 0.2s;
        }
        .btn-green:hover { background: #059669; transform: scale(1.05); }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="video-container">
        <video autoplay muted loop playsinline id="video-bg">
            <source src="https://static.vecteezy.com/system/resources/previews/021/224/146/mp4/flickering-green-neon-light-cannabis-leaf-background-animation-full-hd-and-looping-motion-background-video.mp4" type="video/mp4">
        </video>
    </div>

    <div id="ageGate" class="fixed inset-0 z-[100] bg-black flex items-center justify-center p-6 text-center">
        <div>
            <img src="logo.png" class="h-44 mx-auto mb-10 object-contain">
            <button onclick="enterSite()" class="btn-green px-20 py-6 rounded-full text-2xl uppercase font-black tracking-widest shadow-2xl">Enter Store (21+)</button>
        </div>
    </div>

    <div id="app" class="hidden">
        <header class="py-3">
            <div class="container mx-auto flex flex-col md:flex-row items-center justify-between px-6 gap-6">
                <div class="logo-container cursor-pointer" onclick="goHome()">
                    <img src="logo.png" alt="Smoke Shop Accessories Logo">
                </div>
                <div class="flex items-center gap-6 w-full md:w-auto">
                    <input type="text" id="search" onkeyup="render()" placeholder="Search Products..." class="flex-grow md:w-96 px-6 py-3 rounded-xl outline-none shadow-sm font-semibold">
                    <div class="relative cursor-pointer hover:scale-110 transition-transform" onclick="toggleCart()">
                        <span class="text-3xl">ðŸ›’</span>
                        <span id="cartCount" class="absolute -top-1 -right-2 bg-emerald-500 text-white text-[10px] font-black w-6 h-6 flex items-center justify-center rounded-full">0</span>
                    </div>
                    <button onclick="logout()" class="text-xs font-black text-red-600 uppercase">Logout</button>
                </div>
            </div>
        </header>

        <main class="container mx-auto px-6 py-16">
            <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-10"></div>
        </main>
    </div>

    <div id="cartModal" class="hidden fixed inset-0 z-[110] bg-black/95 backdrop-blur-2xl flex justify-end">
        <div class="bg-white w-full max-w-md h-full p-10 flex flex-col shadow-2xl">
            <div class="flex justify-between items-center mb-10 border-b pb-6 text-gray-900">
                <h2 class="text-3xl font-black uppercase italic">Wholesale Cart</h2>
                <button onclick="toggleCart()" class="text-5xl text-gray-400 hover:text-black">&times;</button>
            </div>
            <div id="cartItems" class="flex-grow overflow-y-auto space-y-4"></div>
            <div class="border-t pt-10 mt-10 text-gray-900">
                <div class="flex justify-between text-3xl font-black mb-10 italic">
                    <span>TOTAL:</span>
                    <span class="text-emerald-600" id="cartTotal">$0.00</span>
                </div>
                <button onclick="submitOrder()" class="w-full btn-green py-6 rounded-2xl text-xl uppercase font-black">Submit Wholesale Order</button>
            </div>
        </div>
    </div>

    <script>
        let products = []; let cart = [];
        let activeUser = JSON.parse(localStorage.getItem('ss_user')) || null;
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw_ntPTHQXVkrYjiFP9-PuqnfD1teJgTnQyT4j4uT0y79mwOE3fW6i_o2KxVjvhkWbj/exec";

        function enterSite() {
            document.getElementById('ageGate').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            fetchData();
        }

        async function fetchData() {
            const res = await fetch(SCRIPT_URL);
            const data = await res.json();
            products = data.products;
            render();
        }

        function render() {
            const q = document.getElementById('search').value.toLowerCase();
            const g = document.getElementById('grid');
            const filtered = products.filter(p => p[0].toString().toLowerCase().includes(q));
            
            g.innerHTML = filtered.map(p => {
                let [n, s, r, w, img] = p;
                let price = (activeUser && activeUser.taxId) ? w : r;
                let finalImg = img || `https://source.unsplash.com/featured/400x400/?smoke,vape,${encodeURIComponent(n)}`;

                return `<div class="glass-card p-6 flex flex-col h-full">
                    <div class="smoke-plume"></div>
                    <div class="product-image-container rounded-2xl overflow-hidden mb-6 h-56 bg-black/50">
                        <img src="${finalImg}" class="w-full h-full object-cover grayscale-[20%] hover:grayscale-0 transition-all">
                    </div>
                    <div class="relative z-10">
                        <h3 class="font-bold text-sm text-white h-12 overflow-hidden uppercase tracking-tight mb-4">${n}</h3>
                        <div class="mt-auto flex justify-between items-center pt-5 border-t border-white/10">
                            <p class="text-2xl font-black text-emerald-400 italic">$${Number(price).toFixed(2)}</p>
                            <button onclick="addToCart('${n}', ${price})" class="btn-green w-12 h-12 rounded-xl text-2xl shadow-lg">+</button>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }

        function logout() { localStorage.removeItem('ss_user'); location.reload(); }
        function goHome() { document.getElementById('search').value = ""; render(); }
        function addToCart(n, p) { 
            const i = cart.find(x => x.name === n); 
            if(i) i.qty++; else cart.push({ name: n, price: p, qty: 1 }); 
            updateCartUI(); 
        }
        function updateCartUI() {
            document.getElementById('cartCount').innerText = cart.reduce((a, b) => a + b.qty, 0);
            const c = document.getElementById('cartItems'); let t = 0;
            c.innerHTML = cart.map((x, idx) => { 
                t += x.price * x.qty; 
                return `<div class="p-4 bg-gray-50 rounded-2xl flex justify-between items-center border">
                    <div><p class="text-[10px] font-black text-gray-900 uppercase">${x.name}</p><p class="text-sm font-bold text-emerald-600">$${x.price}</p></div>
                    <button onclick="removeItem(${idx})" class="text-red-500 font-bold text-xl">Ã—</button>
                </div>` 
            }).join('');
            document.getElementById('cartTotal').innerText = `$${t.toFixed(2)}`;
        }
        function removeItem(idx) { cart.splice(idx, 1); updateCartUI(); }
        function toggleCart() { document.getElementById('cartModal').classList.toggle('hidden'); }
        async function submitOrder() { alert("Wholesale Order Sent!"); cart = []; updateCartUI(); toggleCart(); }

        if(activeUser) { document.getElementById('ageGate').classList.add('hidden'); document.getElementById('app').classList.remove('hidden'); fetchData(); }
    </script>
</body>
</html>
